# ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Boxes - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `boxes` –≤ `backend/apps/`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `apps.py` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º `apps.boxes`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ verbose_name: "–ë–æ–∫—Å—ã (–®–æ—Ç—ã)"

### 2. –ú–æ–¥–µ–ª—å Box
–°–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å —Å–æ –≤—Å–µ–º–∏ —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –ø–æ–ª—è–º–∏:

```python
class Box(models.Model):
    project = ForeignKey(Project, related_name='boxes')  # FK –Ω–∞ Project
    name = CharField(max_length=255)                     # –ù–∞–∑–≤–∞–Ω–∏–µ
    order_index = IntegerField(default=0)                # –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
    created_at = DateTimeField                           # –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
    updated_at = DateTimeField                           # –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    
    class Meta:
        ordering = ['order_index', 'created_at']  # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- FK –Ω–∞ Project —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º related_name='boxes'
- order_index —Å default=0 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–æ–º
- Meta.ordering = ['order_index', 'created_at'] - —Å–Ω–∞—á–∞–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É, –ø–æ—Ç–æ–º –ø–æ –¥–∞—Ç–µ
- –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ü–æ–Ω—è—Ç–Ω—ã–π `__str__()` –º–µ—Ç–æ–¥ —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π

### 3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ
–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å–æ –≤—Å–µ–º–∏ —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- ‚úÖ **list_display**: name, project, order_index, created_at
- ‚úÖ **list_filter**: project, created_at
- ‚úÖ **search_fields**: name
- ‚úÖ **list_editable**: order_index - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø—Ä—è–º–æ –∏–∑ —Å–ø–∏—Å–∫–∞!
- ‚úÖ **readonly_fields**: created_at, updated_at
- ‚úÖ **fieldsets**: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π —Å —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫

**–ö–ª—é—á–µ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:**
üîÑ `list_editable = ('order_index',)` –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –±–æ–∫—Å–æ–≤ –ø—Ä—è–º–æ –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–¥–º–∏–Ω–∫–∏ –±–µ–∑ –≤—Ö–æ–¥–∞ –≤ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É!

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ INSTALLED_APPS
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `apps.boxes` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `config/settings.py`

### 5. –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è: `apps/boxes/migrations/0001_initial.py`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ –ë–î
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `boxes_box` —Å–æ–∑–¥–∞–Ω–∞ –≤ PostgreSQL
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `projects.0001_initial` –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω–∞

### 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (Best Practices)
- ‚úÖ –°–æ–∑–¥–∞–Ω `services.py` —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π:
  - `create_box()` - —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ–∫—Å–∞
  - `update_box()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ–∫—Å–∞
  - `reorder_boxes()` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –±–æ–∫—Å–æ–≤ (bulk update)
  - `delete_box()` - —É–¥–∞–ª–µ–Ω–∏–µ –±–æ–∫—Å–∞
  - `get_project_boxes()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –±–æ–∫—Å–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ —Å select_related
  - –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å type hints
  
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã –≤ `tests.py`:
  - –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, str, ordering, related_name)
  - –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (CRUD, reorder)
  - **9 —Ç–µ—Å—Ç–æ–≤ - –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ ‚úì**

- ‚úÖ –°–æ–∑–¥–∞–Ω `README.md` —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
backend/apps/boxes/
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 0001_initial.py       # –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ admin.py                  # –ê–¥–º–∏–Ω–∫–∞ —Å list_editable –¥–ª—è order_index
‚îú‚îÄ‚îÄ apps.py                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ models.py                 # –ú–æ–¥–µ–ª—å Box —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ordering
‚îú‚îÄ‚îÄ services.py               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–≤–∫–ª—é—á–∞—è reorder)
‚îú‚îÄ‚îÄ tests.py                  # 9 unit-—Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ views.py                  # Placeholder –¥–ª—è –±—É–¥—É—â–∏—Ö views
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

```
User (apps.users)
  ‚îî‚îÄ> Project (apps.projects)
        ‚îî‚îÄ> Box (apps.boxes)  [related_name='boxes']
```

**Cascade-—É–¥–∞–ª–µ–Ω–∏–µ:** –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ Project –≤—Å–µ –µ–≥–æ Box –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è (on_delete=CASCADE).

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç—ã
```bash
docker compose exec backend python manage.py test apps.boxes
# Found 9 test(s).
# Ran 9 tests in 0.969s
# OK ‚úì
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
docker compose exec backend python manage.py migrate
# Applying boxes.0001_initial... OK ‚úì
```

### –ú–æ–¥–µ–ª—å
```bash
Box model: –ë–æ–∫—Å—ã (–®–æ—Ç—ã)
Fields: ['id', 'project', 'name', 'order_index', 'created_at', 'updated_at']
Ordering: ['order_index', 'created_at'] ‚úì
```

### System Check
```bash
docker compose exec backend python manage.py check
# System check identified no issues (0 silenced). ‚úì
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
Meta.ordering = ['order_index', 'created_at'] –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ü–µ—Ä–≤–∏—á–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ order_index (–¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏)
- –í—Ç–æ—Ä–∏—á–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ created_at (–µ—Å–ª–∏ order_index –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)

### 2. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
`list_editable = ('order_index',)` –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –í–∏–¥–µ—Ç—å –≤—Å–µ –±–æ–∫—Å—ã –≤ —Å–ø–∏—Å–∫–µ
- –ú–µ–Ω—è—Ç—å order_index –ø—Ä—è–º–æ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–∞—Å—Å–æ–≤–æ –∫–Ω–æ–ø–∫–æ–π "Save"
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞–∂–¥–æ–≥–æ –±–æ–∫—Å–∞

### 3. –°–µ—Ä–≤–∏—Å reorder_boxes
```python
reorder_boxes([box3.id, box1.id, box2.id])  # –ù–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫
```
–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç order_index –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–æ–∫—Å–æ–≤ –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π (bulk update).

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
`get_project_boxes()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `select_related('project')` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î.

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

‚úÖ –°–ª–µ–¥—É–µ—Ç .cursorrules:
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ services.py
- –ú–æ–¥–µ–ª–∏ —Å created_at/updated_at
- –†—É—Å—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è verbose_name
- Type hints –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö
- select_related –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ –°–ª–µ–¥—É–µ—Ç TECHNICAL.md:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ apps/boxes/
- –ú–æ–¥–µ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "3. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö"
- Django 5.x –∏–¥–∏–æ–º–∞—Ç–∏–∫–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ related_name –∏ CASCADE

‚úÖ –°–ª–µ–¥—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞—á–∏:
- –í—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ordering = ['order_index', 'created_at']
- list_editable –¥–ª—è order_index –≤ –∞–¥–º–∏–Ω–∫–µ
- –í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–°–æ–≥–ª–∞—Å–Ω–æ TECHNICAL.md, —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:
1. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ Asset (—Å FK –Ω–∞ Box)
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è headliner_asset_id –≤ Box (FK –Ω–∞ Asset, nullable)
3. –°–æ–∑–¥–∞–Ω–∏–µ API ViewSets –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
4. Endpoint –¥–ª—è –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è –±–æ–∫—Å–æ–≤: `POST /api/boxes/{id}/reorder/`
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DRF —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
