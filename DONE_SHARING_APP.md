# ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Sharing - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `sharing` –≤ `backend/apps/`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `apps.py` —Å –∏–º–µ–Ω–µ–º `apps.sharing`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ verbose_name: "–ü—É–±–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏"

### 2. –ú–æ–¥–µ–ª—å SharedLink
–ü—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```python
class SharedLink(models.Model):
    project = ForeignKey(Project, related_name='shared_links')
    token = UUIDField(
        unique=True,
        default=uuid.uuid4,
        editable=False  # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
    )
    expires_at = DateTimeField(
        null=True,
        blank=True,  # null = –±–µ—Å—Å—Ä–æ—á–Ω–∞—è
        help_text='–ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –±–µ–∑ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è'
    )
    created_at, updated_at = DateTimeField
    
    class Meta:
        verbose_name = '–ü—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞'
        ordering = ['-created_at']
    
    def is_expired(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞."""
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üîë UUID —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (`default=uuid.uuid4`)
- üîí `editable=False` - –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω
- ‚è∞ –ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (expires_at=null)
- ‚úÖ –ú–µ—Ç–æ–¥ `is_expired()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
- üìù `__str__()` —Å –¥–∞—Ç–æ–π –∏—Å—Ç–µ—á–µ–Ω–∏—è –∏–ª–∏ "–±–µ—Å—Å—Ä–æ—á–Ω–∞—è"

### 3. –ú–æ–¥–µ–ª—å Comment
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±–æ–∫—Å—É –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É:

```python
class Comment(models.Model):
    box = ForeignKey(Box, related_name='comments')
    author_name = CharField(max_length=100)  # –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
    text = TextField()                        # –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    is_read = BooleanField(default=False)    # –û—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏
    created_at, updated_at = DateTimeField
    
    class Meta:
        verbose_name = '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'
        ordering = ['-created_at']  # –ù–æ–≤—ã–µ –ø–µ—Ä–≤—ã–º–∏
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üí¨ –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–±–µ–∑ User FK)
- ‚úÖ –û—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏ (is_read)
- üìù `__str__()` —Å —ç–º–æ–¥–∑–∏ —Å—Ç–∞—Ç—É—Å–∞ (‚úì/‚úó) –∏ –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞
- üîΩ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–º–∏)

### 4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

#### SharedLink Admin
- **list_display**: token (—É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–π), project, expires_at, **status** (—Ü–≤–µ—Ç–Ω–æ–π!), created_at
- **list_filter**: created_at, expires_at, project__user
- **search_fields**: token, project__name
- **readonly_fields**: token (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç–æ–¥—ã**:
  - `token_display()` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 13 —Å–∏–º–≤–æ–ª–æ–≤ –≤ `<code>`
  - `status_display()` - —Ü–≤–µ—Ç–Ω–æ–π —Å—Ç–∞—Ç—É—Å:
    - ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ (–∑–µ–ª–µ–Ω—ã–π)
    - ‚ùå –ò—Å—Ç–µ–∫–ª–∞ (–∫—Ä–∞—Å–Ω—ã–π)

#### Comment Admin
- **list_display**: author_name, box, text_preview, is_read, created_at
- **list_filter**: is_read, created_at, box__project
- **search_fields**: author_name, text, box__name
- **list_editable**: is_read - –æ—Ç–º–µ—á–∞—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –ø—Ä—è–º–æ –∏–∑ —Å–ø–∏—Å–∫–∞! üî•
- **Actions** (–º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏):
  - `mark_as_read` - –æ—Ç–º–µ—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
  - `mark_as_unread` - –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç–æ–¥—ã**:
  - `text_preview()` - –ø–µ—Ä–≤—ã–µ 60 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞

### 5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ INSTALLED_APPS
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `apps.sharing` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `config/settings.py`

### 6. –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è: `0001_initial.py`
  - –°–æ–∑–¥–∞–Ω–∏–µ Comment
  - –°–æ–∑–¥–∞–Ω–∏–µ SharedLink
  - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: boxes, projects
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ –ë–î

### 7. –°–µ—Ä–≤–∏—Å—ã

–°–æ–∑–¥–∞–Ω–æ **10 —Ñ—É–Ω–∫—Ü–∏–π** –≤ `services.py`:

**SharedLink Services:**
- `create_shared_link(project, expires_in_days=None)` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏
- `revoke_shared_link(link)` - –æ—Ç–∑—ã–≤ —Å—Å—ã–ª–∫–∏ (—É–¥–∞–ª–µ–Ω–∏–µ)
- `get_project_by_token(token)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Ç–æ–∫–µ–Ω—É (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ä–æ–∫–∞!)
- `get_active_links(project)` - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞

**Comment Services:**
- `create_comment(box, author_name, text)` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- `mark_comment_as_read(comment)` - –æ—Ç–º–µ—Ç–∫–∞ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–π
- `get_box_comments(box, unread_only=False)` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±–æ–∫—Å–∞
- `get_project_comments(project, unread_only=False)` - –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- `get_unread_count(project)` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

**–í—Å–µ —Å select_related –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏!**

### 8. –¢–µ—Å—Ç—ã

**21 unit-—Ç–µ—Å—Ç** –ø–æ–∫—Ä—ã–≤–∞–µ—Ç:

**SharedLink:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å UUIDField
- –ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ –∏ —Å–æ —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è
- –ú–µ—Ç–æ–¥ `is_expired()` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
- –û–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å —á–µ—Ä–µ–∑ related_name

**Comment:**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã
- –°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ (‚úì/‚úó)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–º–∏)
- –û–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å —á–µ—Ä–µ–∑ related_name

**Services:**
- –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫—É –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é unread_only
- –ü–æ–¥—Å—á–µ—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

–í—Å–µ 21 —Ç–µ—Å—Ç ‚úì | –í—Å–µ 63 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ ‚úì

### 9. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω –ø–æ–¥—Ä–æ–±–Ω—ã–π `README.md`:
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–ª–µ–π
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã Views –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket (–±—É–¥—É—â–µ–µ)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ best practices

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
backend/apps/sharing/
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 0001_initial.py        # SharedLink + Comment
‚îú‚îÄ‚îÄ admin.py                   # –ê–¥–º–∏–Ω–∫–∞ —Å —Ü–≤–µ—Ç–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ actions
‚îú‚îÄ‚îÄ models.py                  # SharedLink (UUID), Comment
‚îú‚îÄ‚îÄ services.py                # 10 —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ tests.py                   # 21 —Ç–µ—Å—Ç
‚îî‚îÄ‚îÄ README.md                  # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

```
User ‚Üí Project ‚Üí SharedLink (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø–æ UUID)
              ‚Üì
            Box ‚Üí Comment (–∞–Ω–æ–Ω–∏–º–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)
```

**–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:**
- Project —É–¥–∞–ª—è–µ—Ç—Å—è ‚Üí –≤—Å–µ SharedLink —É–¥–∞–ª—è—é—Ç—Å—è (CASCADE)
- Box —É–¥–∞–ª—è–µ—Ç—Å—è ‚Üí –≤—Å–µ Comment —É–¥–∞–ª—è—é—Ç—Å—è (CASCADE)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç—ã
```bash
# –¢–µ—Å—Ç—ã sharing
docker compose exec backend python manage.py test apps.sharing
# Found 21 test(s)
# Ran 21 tests in 1.929s
# OK ‚úì

# –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
docker compose exec backend python manage.py test
# Found 63 test(s)
# Ran 63 tests in 4.648s
# OK ‚úì‚úì‚úì
```

### System Check
```bash
docker compose exec backend python manage.py check
# System check identified no issues (0 silenced) ‚úì
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Å—ã–ª–∫–∏

```python
from apps.sharing.services import create_shared_link

# –ë–µ—Å—Å—Ä–æ—á–Ω–∞—è —Å—Å—ã–ª–∫–∞
link = create_shared_link(project)
public_url = f'https://myapp.com/public/{link.token}/'

# –°—Å—ã–ª–∫–∞ –Ω–∞ 7 –¥–Ω–µ–π
link = create_shared_link(project, expires_in_days=7)
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```python
from apps.sharing.services import get_project_by_token

def public_view(request, token):
    project = get_project_by_token(token)
    
    if project is None:
        # –°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –∏—Å—Ç–µ–∫–ª–∞
        return HttpResponse('–°—Å—ã–ª–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞', status=404)
    
    # –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
    return render(request, 'public/project.html', {'project': project})
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

```python
from apps.sharing.services import create_comment

# –ö–ª–∏–µ–Ω—Ç –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
comment = create_comment(
    box=box,
    author_name='–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
    text='–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç?'
)
```

### 4. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

```python
from apps.sharing.services import get_unread_count, get_project_comments

# –í dashboard –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø—Ä–æ–µ–∫—Ç–∞
unread_count = get_unread_count(project)
unread_comments = get_project_comments(project, unread_only=True)

context = {
    'unread_count': unread_count,  # –ü–æ–∫–∞–∑–∞—Ç—å badge
    'comments': unread_comments
}
```

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚úÖ **UUID —Ç–æ–∫–µ–Ω—ã** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å (–Ω–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ ID)  
‚úÖ **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - —Ç–æ–∫–µ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏  
‚úÖ **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è** - –±–µ—Å—Å—Ä–æ—á–Ω—ã–µ –∏–ª–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è** - –º–µ—Ç–æ–¥ `is_expired()`  
‚úÖ **–û—Ç–∑—ã–≤** - –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É  
‚úÖ **–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - –Ω–µ —Ç—Ä–µ–±—É—é—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏  
‚úÖ **–û—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö  
‚úÖ **–ú–∞—Å—Å–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** - –≤ –∞–¥–º–∏–Ω–∫–µ (mark_as_read/unread)  

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

üîí **Read-only –¥–æ—Å—Ç—É–ø** - —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç  
üîí **UUID —Ç–æ–∫–µ–Ω—ã** - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ, 128 –±–∏—Ç  
üîí **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è** - –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—Ä–µ–º—è –¥–æ—Å—Ç—É–ø–∞  
üîí **–û—Ç–∑—ã–≤ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç** - —É–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –∏–∑ –ë–î  
üîí **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - `get_project_by_token()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–æ–∫  

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

‚úÖ –°–ª–µ–¥—É–µ—Ç .cursorrules:
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ services.py
- –ú–æ–¥–µ–ª–∏ —Å created_at/updated_at
- –†—É—Å—Å–∫–∏–µ verbose_name
- Type hints –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö
- select_related –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ –°–ª–µ–¥—É–µ—Ç TECHNICAL.md:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ apps/sharing/
- –ú–æ–¥–µ–ª–∏ SharedLink –∏ Comment –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "3. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö"
- UUID —Ç–æ–∫–µ–Ω (–Ω–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π ID)
- expires_at –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API

‚úÖ –°–ª–µ–¥—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:
- –í—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- UUIDField —Å default=uuid.uuid4, editable=False, unique=True
- expires_at (null=True, blank=True)
- Meta.ordering –¥–ª—è Comment = ['-created_at']
- –ê–¥–º–∏–Ω–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–æ–∏—Å–∫–æ–º
- list_editable –¥–ª—è is_read –≤ Comment

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
üì¶ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–π:       6 (users, projects, boxes, assets, ai_providers, sharing)
üóÑÔ∏è  –ú–æ–¥–µ–ª–µ–π:          8 (+2: SharedLink, Comment)
üß™ –¢–µ—Å—Ç–æ–≤:          63 (–≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úì)
üìù –ú–∏–≥—Ä–∞—Ü–∏–π:         7 (–≤—Å–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã ‚úì)
üìä –ê–¥–º–∏–Ω–∫–∞:          8 –º–æ–¥–µ–ª–µ–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
üîß –°–µ—Ä–≤–∏—Å–æ–≤:        35 —Ñ—É–Ω–∫—Ü–∏–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (+10)
üîó UUID —Ç–æ–∫–µ–Ω—ã:      –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:      —Å –æ—Ç–º–µ—Ç–∫–æ–π –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

### API endpoints (–±—É–¥—É—â–µ–µ)

```
# Public (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø–æ —Ç–æ–∫–µ–Ω—É)
GET  /api/public/{token}/              # –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
GET  /api/public/{token}/boxes/        # –ë–æ–∫—Å—ã —Å –∞—Å—Å–µ—Ç–∞–º–∏
POST /api/public/{token}/comments/     # –û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

# Private (—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π)
POST /api/projects/{id}/share/         # –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É
  Body: {"expires_in_days": 7}
  
GET  /api/projects/{id}/shared-links/  # –°–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫
DEL  /api/shared-links/{id}/           # –û—Ç–æ–∑–≤–∞—Ç—å —Å—Å—ã–ª–∫—É

GET  /api/projects/{id}/comments/      # –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
  Query: ?unread_only=true
  
PATCH /api/comments/{id}/              # –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
  Body: {"is_read": true}
```

### WebSocket —Å–æ–±—ã—Ç–∏—è (–±—É–¥—É—â–µ–µ)

```javascript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
ws://myapp.com/ws/projects/{project_id}/

// –°–æ–±—ã—Ç–∏—è
{
  "type": "new_comment",
  "comment_id": 123,
  "author_name": "–ò–≤–∞–Ω",
  "box_id": 45,
  "text": "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!"
}
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ú–æ–∂–Ω–æ:
1. ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
2. ‚úÖ –î–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
3. ‚úÖ –ü—Ä–∏–Ω–∏–º–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
4. ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
5. üîú –°–æ–∑–¥–∞—Ç—å API endpoints –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
6. üîú WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
7. üîú Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
